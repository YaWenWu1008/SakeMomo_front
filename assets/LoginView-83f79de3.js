import{M as x,ae as S,N as k,af as B,R as N,S as C,T as s,c as a,ag as y,$ as t,ah as F,ai as d,a6 as c,K as m,a0 as p}from"./index-f067b331.js";import{c as M,a as V,u as R,d as f,V as T}from"./index.esm-7c7231d6.js";import{V as U,b as n,a as $}from"./VRow-937e43ab.js";import{V as q}from"./VSheet-8f3544c2.js";import"./_commonjsHelpers-725317a4.js";const P=c("h1",null,"登入",-1),D={class:"text-center"},K=c("p",null,"還不是會員",-1),H={__name:"LoginView",setup(L){const i=x(),b=S(),_=k(),g=M({account:V().required("帳號必填").min(4,"帳號最少 4 個字").max(20,"帳號最多 20 個字"),password:V().required("密碼必填").min(4,"密碼最少 4 個字").max(20,"密碼最多 20 個字")}),{handleSubmit:h,isSubmitting:v}=R({validationSchema:g}),o=f("account"),r=f("password"),w=h(async l=>{try{const{data:e}=await B.post("/users/login",{account:l.account,password:l.password});_.login({token:e.result.token,account:e.result.account,email:e.result.email,phoneNumber:e.result.phoneNumber,reservation:e.result.reservation,role:e.result.role}),i({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),b.push("/")}catch(e){i({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(l,e)=>(N(),C(U,null,{default:s(()=>[a($,{class:"loginRow"},{default:s(()=>[a(n,{cols:"12"},{default:s(()=>[P]),_:1}),a(y),a(n,null,{default:s(()=>[a(q,{width:"300",class:"mx-auto"},{default:s(()=>[a(T,{disabled:t(v),onSubmit:F(t(w),["prevent"])},{default:s(()=>[a(d,{modelValue:t(o).value.value,"onUpdate:modelValue":e[0]||(e[0]=u=>t(o).value.value=u),"error-messages":t(o).errorMessage.value,label:"帳號",counter:"",maxlength:"20"},null,8,["modelValue","error-messages"]),a(d,{modelValue:t(r).value.value,"onUpdate:modelValue":e[1]||(e[1]=u=>t(r).value.value=u),"error-messages":t(r).errorMessage.value,label:"密碼",counter:"",maxlength:"20",type:"password"},null,8,["modelValue","error-messages"]),c("div",D,[a(m,{type:"submit",color:"green-darken-3"},{default:s(()=>[p("登入")]),_:1})])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1}),a(n,{class:"text-center"},{default:s(()=>[K,a(m,{to:"/register"},{default:s(()=>[p("點我註冊")]),_:1})]),_:1})]),_:1})]),_:1}))}};export{H as default};
